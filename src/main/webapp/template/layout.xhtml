<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="jakarta.faces.facelets" xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core" xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Gestion de Proveedores</title>
        <h:outputStylesheet name="css/misEstilos.css" />
        <h:outputScript name="js/misScript.js" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
              integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous" />
    </h:head>

    <h:body pt:data-bs-theme="dark" pt:class="d-flex flex-column vh-100">

        <!-- Botón hamburguesa (móviles) -->
        <button class="menu-toggle" id="menuToggle" onclick="toggleSidebar()">
            <i class="bi bi-list"></i>
        </button>

        <!-- Overlay para cerrar el menú en móviles -->
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

        <div class="container-fluid flex-grow-1">
            <div class="row h-100">
                <aside class="col-md-3 col-lg-2 p-3 sidebar" id="sidebar">
                    <!-- Botón de cierre dentro del sidebar (solo visible en móviles) -->
                    <button class="sidebar-close" onclick="closeSidebar()">
                        <i class="bi bi-x-lg"></i>
                    </button>
                    
                    <!-- Botón para colapsar/expandir (solo desktop) -->
                    <button class="sidebar-collapse-btn" id="collapseBtn" onclick="toggleCollapse()">
                        <i class="bi bi-chevron-left" id="collapseIcon"></i>
                    </button>
                    
                    <h3 class="mb-4 sidebar-title">
                        <i class="bi bi-gear"></i> 
                        <span class="sidebar-text">Opciones</span>
                    </h3>

                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <h:link outcome="/index.xhtml" class="nav-link #{view.viewId == '/index.xhtml' ? 'active' : ''}">
                                <i class="bi bi-house"></i>
                                <span class="sidebar-text">Inicio</span>
                            </h:link>
                        </li>
                        <li class="nav-item">
                            <h:link outcome="/proveedores/index.xhtml" class="nav-link #{view.viewId == '/proveedores/index.xhtml' ? 'active' : ''}">
                                <i class="bi bi-truck"></i>
                                <span class="sidebar-text">Proveedores</span>
                            </h:link>
                        </li>
                        <li class="nav-item">
                            <h:link outcome="/productos/index.xhtml" class="nav-link #{view.viewId == '/productos/index.xhtml' ? 'active' : ''}">
                                <i class="bi bi-basket3"></i>
                                <span class="sidebar-text">Productos</span>
                            </h:link>
                        </li>
                   <li class="nav-item dropdown">

    <!-- Este link lleva directamente a Facturas Impagas -->
    <h:link outcome="/facturas/index.xhtml" 
            class="nav-link #{view.viewId == '/facturas/index.xhtml' ? 'active' : ''}">
        <i class="bi bi-receipt-cutoff"></i>
        <span class="sidebar-text">Facturas</span>
    </h:link>


</li>


                        <li class="nav-item">
                            <h:link outcome="/pagos/index.xhtml" class="nav-link #{view.viewId == '/pagos/index.xhtml' ? 'active' : ''}" >
                                <i class="bi bi-credit-card"></i>
                                <span class="sidebar-text">Pagos</span>
                            </h:link>
                        </li>
                        <li class="nav-item">
                            <h:link outcome="/cuentasCorrientes/index.xhtml" class="nav-link #{view.viewId == '/cuentasCorrientes/index.xhtml' ? 'active' : ''}">
                                <i class="bi bi-bank"></i>
                                <span class="sidebar-text">Cuentas Corrientes</span>
                            </h:link>
                        </li>
                        <ui:fragment rendered="#{controladorUsuario.usuarioLogueado.rol == 'gerente' || controladorUsuario.usuarioLogueado.rol == 'admin'}">
                            <li class="nav-item">
                                <h:link class="nav-link" outcome="/auditoria/index.xhtml">
                                    <i class="bi bi-clipboard-check"></i>
                                    <span class="sidebar-text">Auditoria</span>
                                </h:link>
                            </li>
                        </ui:fragment>
                        <ui:fragment rendered="#{controladorUsuario.usuarioLogueado.rol == 'admin'}">
                            <li class="nav-item">
                                <h:link outcome="/usuarios/index.xhtml" class="nav-link #{view.viewId == '/usuarios/index.xhtml' ? 'active' : ''}">
                                    <i class="bi bi-person"></i>
                                    <span class="sidebar-text">Usuarios</span>
                                </h:link>
                            </li>
                        </ui:fragment>
                        
                        <!-- LOGOUT CON FORMULARIO -->
                        <li class="nav-item">
                            <h:form style="margin: 0; padding: 0;">
                                <h:commandLink action="#{controladorUsuario.logout()}" 
                                               styleClass="nav-link"
                                               onclick="if(!confirm('¿Estás seguro de cerrar sesión?')) return false;">
                                    <i class="bi bi-box-arrow-left"></i>
                                    <span class="sidebar-text">Cerrar Sesión</span>
                                </h:commandLink>
                            </h:form>
                        </li>
                    </ul>
                </aside>

                <main class="col-md-9 col-lg-10 p-4" id="mainContent">
                    <ui:insert name="contenido">
                    </ui:insert>
                </main>
            </div>
        </div>

        <!-- Bootstrap JS Bundle -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
    </h:body>

</html>