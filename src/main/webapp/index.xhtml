<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="jakarta.faces.facelets"
                template="./template/layout.xhtml" xmlns:h="jakarta.faces.html" xmlns:f="jakarta.faces.core"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="contenido">

        <h:panelGroup rendered="#{controladorSesion.isLogueado()}">
            <p>Bienvenido: <strong>#{controladorSesion.usuarioLogueado.username}</strong></p>
            <h:commandLink action="#{controladorSesion.logout()}" value="Cerrar Sesión" />
        </h:panelGroup>

        <p:outputPanel id="seccionGraficos">
            <div class="dashboard-grid">

                <div class="kpi-card full-width">
                    <h3 class="kpi-titulo">Deuda Total Actual</h3>
                    <h:outputText value="#{controladorDashboard.deudaTotal}" styleClass="kpi-numero">
                        <f:convertNumber type="currency" currencySymbol="$" />
                    </h:outputText>
                </div>

                <p:card styleClass="chart-card">
                    <f:facet name="title">Top 5 Proveedores (Deuda)</f:facet>
                    <p:barChart model="#{controladorDashboard.proveedoresModel}" style="width: 100%; height: 250px;" />
                </p:card>

                <p:card styleClass="chart-card">
                    <f:facet name="title">Distribución de Pagos</f:facet>
                    <p:donutChart model="#{controladorDashboard.formasPagoModel}" style="width: 100%; height: 250px;" />
                </p:card>

                <p:card styleClass="chart-card">
                    <f:facet name="title">Top 5 Productos (Unidades)</f:facet>
                    <p:barChart model="#{controladorDashboard.productosModel}" style="width: 100%; height: 250px;" />
                </p:card>

            </div>
        </p:outputPanel>


    </ui:define>

</ui:composition>